Starting training
Saving initial checkpoint to scratch-sentiment-gpt2\ckpt.pt
Initial checkpoint saved successfully: 474.10 MB
iter 50: loss 1.0397, lr 0.000000
iter 100: loss 0.9178, lr 0.000009
iter 150: loss 0.8322, lr 0.000018
iter 200: loss 0.8202, lr 0.000018

--- Validation at iteration 250 ---
step 250: val loss 0.6434, val accuracy 0.7216
Logging validation metrics to wandb...
[DEBUG] Logging to wandb at iter 250: {'iter': 250, 'val/loss': 0.6434373259544373, 'val/accuracy': 0.7216494845360825, 'val/f1_score': 0.7153327075168644, 'lr': 2.6625e-05, 'progress': 12.5, 'best/loss': 0.6434373259544373, 'best/accuracy': 0.7216494845360825, 'best/f1': 0.7153327075168644, 'best/iter': 250, 'val/precision_negative': np.float64(0.6339285714285714), 'val/recall_negative': np.float64(0.8658536585365854), 'val/f1_negative': np.float64(0.7319587628865979), 'val/precision_neutral': np.float64(0.8414634146341463), 'val/recall_neutral': np.float64(0.6330275229357798), 'val/f1_neutral': np.float64(0.7225130890052356), 'val/precision_positive': np.float64(0.0), 'val/recall_positive': np.float64(0.0), 'val/f1_positive': np.float64(0.0), 'val/conf_matrix_negative_negative': np.int64(71), 'val/conf_matrix_negative_neutral': np.int64(11), 'val/conf_matrix_negative_positive': np.int64(0), 'val/conf_matrix_neutral_negative': np.int64(40), 'val/conf_matrix_neutral_neutral': np.int64(69), 'val/conf_matrix_neutral_positive': np.int64(0), 'val/conf_matrix_positive_negative': np.int64(1), 'val/conf_matrix_positive_neutral': np.int64(2), 'val/conf_matrix_positive_positive': np.int64(0), 'val/conf_matrix_plot': CustomChart(table=<wandb.sdk.data_types.table.Table object at 0x0000020E90933650>, spec=CustomChartSpec(spec_name='wandb/confusion_matrix/v1', fields={'Actual': 'Actual', 'Predicted': 'Predicted', 'nPredictions': 'nPredictions'}, string_fields={'title': 'Confusion Matrix Curve'}, key='', panel_type='Vega2', split_table=False))}
Wandb logging completed.
Saving checkpoint to scratch-sentiment-gpt2\ckpt.pt
Checkpoint saved successfully: 1422.31 MB
--- End of validation at iteration 250 ---

iter 250: loss 0.7242, lr 0.000027
iter 300: loss 0.5523, lr 0.000036
iter 350: loss 0.4971, lr 0.000036
iter 400: loss 0.3639, lr 0.000044
iter 450: loss 0.3903, lr 0.000050

--- Validation at iteration 500 ---
step 500: val loss 0.6027, val accuracy 0.8144
Logging validation metrics to wandb...
[DEBUG] Logging to wandb at iter 500: {'iter': 500, 'val/loss': 0.6026517152786255, 'val/accuracy': 0.8144329896907216, 'val/f1_score': 0.7993953957057592, 'lr': 4.984563393995508e-05, 'progress': 25.0, 'best/loss': 0.6026517152786255, 'best/accuracy': 0.8144329896907216, 'best/f1': 0.7993953957057592, 'best/iter': 500, 'val/precision_negative': np.float64(0.9803921568627451), 'val/recall_negative': np.float64(0.6097560975609756), 'val/f1_negative': np.float64(0.7518796992481203), 'val/precision_neutral': np.float64(0.7552447552447552), 'val/recall_neutral': np.float64(0.9908256880733946), 'val/f1_neutral': np.float64(0.8571428571428571), 'val/precision_positive': np.float64(0.0), 'val/recall_positive': np.float64(0.0), 'val/f1_positive': np.float64(0.0), 'val/conf_matrix_negative_negative': np.int64(50), 'val/conf_matrix_negative_neutral': np.int64(32), 'val/conf_matrix_negative_positive': np.int64(0), 'val/conf_matrix_neutral_negative': np.int64(1), 'val/conf_matrix_neutral_neutral': np.int64(108), 'val/conf_matrix_neutral_positive': np.int64(0), 'val/conf_matrix_positive_negative': np.int64(0), 'val/conf_matrix_positive_neutral': np.int64(3), 'val/conf_matrix_positive_positive': np.int64(0), 'val/conf_matrix_plot': CustomChart(table=<wandb.sdk.data_types.table.Table object at 0x0000020E90954C50>, spec=CustomChartSpec(spec_name='wandb/confusion_matrix/v1', fields={'Actual': 'Actual', 'Predicted': 'Predicted', 'nPredictions': 'nPredictions'}, string_fields={'title': 'Confusion Matrix Curve'}, key='', panel_type='Vega2', split_table=False))}
Wandb logging completed.
Saving checkpoint to scratch-sentiment-gpt2\ckpt.pt
Checkpoint saved successfully: 1422.31 MB
--- End of validation at iteration 500 ---

iter 500: loss 0.3598, lr 0.000050
iter 550: loss 0.4003, lr 0.000050
iter 600: loss 0.3291, lr 0.000050
iter 650: loss 0.4898, lr 0.000049
iter 700: loss 0.3503, lr 0.000049

--- Validation at iteration 750 ---
step 750: val loss 0.4747, val accuracy 0.8660
Logging validation metrics to wandb...
[DEBUG] Logging to wandb at iter 750: {'iter': 750, 'val/loss': 0.4746997654438019, 'val/accuracy': 0.865979381443299, 'val/f1_score': 0.8585434875520274, 'lr': 4.84399261276768e-05, 'progress': 37.5, 'best/loss': 0.4746997654438019, 'best/accuracy': 0.865979381443299, 'best/f1': 0.8585434875520274, 'best/iter': 750, 'val/precision_negative': np.float64(0.8933333333333333), 'val/recall_negative': np.float64(0.8170731707317073), 'val/f1_negative': np.float64(0.8535031847133758), 'val/precision_neutral': np.float64(0.8487394957983193), 'val/recall_neutral': np.float64(0.926605504587156), 'val/f1_neutral': np.float64(0.8859649122807017), 'val/precision_positive': np.float64(0.0), 'val/recall_positive': np.float64(0.0), 'val/f1_positive': np.float64(0.0), 'val/conf_matrix_negative_negative': np.int64(67), 'val/conf_matrix_negative_neutral': np.int64(15), 'val/conf_matrix_negative_positive': np.int64(0), 'val/conf_matrix_neutral_negative': np.int64(8), 'val/conf_matrix_neutral_neutral': np.int64(101), 'val/conf_matrix_neutral_positive': np.int64(0), 'val/conf_matrix_positive_negative': np.int64(0), 'val/conf_matrix_positive_neutral': np.int64(3), 'val/conf_matrix_positive_positive': np.int64(0), 'val/conf_matrix_plot': CustomChart(table=<wandb.sdk.data_types.table.Table object at 0x0000020E90001C10>, spec=CustomChartSpec(spec_name='wandb/confusion_matrix/v1', fields={'Actual': 'Actual', 'Predicted': 'Predicted', 'nPredictions': 'nPredictions'}, string_fields={'title': 'Confusion Matrix Curve'}, key='', panel_type='Vega2', split_table=False))}
Wandb logging completed.
Saving checkpoint to scratch-sentiment-gpt2\ckpt.pt
Checkpoint saved successfully: 1422.31 MB
--- End of validation at iteration 750 ---

iter 750: loss 0.2840, lr 0.000048
iter 800: loss 0.3299, lr 0.000048
iter 850: loss 0.3112, lr 0.000048
iter 900: loss 0.2670, lr 0.000047
iter 950: loss 0.2565, lr 0.000046

--- Validation at iteration 1000 ---
step 1000: val loss 0.3750, val accuracy 0.8505
Logging validation metrics to wandb...
[DEBUG] Logging to wandb at iter 1000: {'iter': 1000, 'val/loss': 0.3750099837779999, 'val/accuracy': 0.8505154639175257, 'val/f1_score': 0.8441056595258577, 'lr': 4.444921762887826e-05, 'progress': 50.0, 'best/loss': 0.3750099837779999, 'best/accuracy': 0.865979381443299, 'best/f1': 0.8585434875520274, 'best/iter': 1000, 'val/precision_negative': np.float64(0.8181818181818182), 'val/recall_negative': np.float64(0.8780487804878049), 'val/f1_negative': np.float64(0.8470588235294118), 'val/precision_neutral': np.float64(0.8773584905660378), 'val/recall_neutral': np.float64(0.8532110091743119), 'val/f1_neutral': np.float64(0.8651162790697674), 'val/precision_positive': np.float64(0.0), 'val/recall_positive': np.float64(0.0), 'val/f1_positive': np.float64(0.0), 'val/conf_matrix_negative_negative': np.int64(72), 'val/conf_matrix_negative_neutral': np.int64(10), 'val/conf_matrix_negative_positive': np.int64(0), 'val/conf_matrix_neutral_negative': np.int64(16), 'val/conf_matrix_neutral_neutral': np.int64(93), 'val/conf_matrix_neutral_positive': np.int64(0), 'val/conf_matrix_positive_negative': np.int64(0), 'val/conf_matrix_positive_neutral': np.int64(3), 'val/conf_matrix_positive_positive': np.int64(0), 'val/conf_matrix_plot': CustomChart(table=<wandb.sdk.data_types.table.Table object at 0x0000020E908F9050>, spec=CustomChartSpec(spec_name='wandb/confusion_matrix/v1', fields={'Actual': 'Actual', 'Predicted': 'Predicted', 'nPredictions': 'nPredictions'}, string_fields={'title': 'Confusion Matrix Curve'}, key='', panel_type='Vega2', split_table=False))}
Wandb logging completed.
Saving checkpoint to scratch-sentiment-gpt2\ckpt.pt
Checkpoint saved successfully: 1422.31 MB
--- End of validation at iteration 1000 ---

iter 1000: loss 0.2543, lr 0.000044
iter 1050: loss 0.2330, lr 0.000044
iter 1100: loss 0.1963, lr 0.000043
iter 1150: loss 0.2081, lr 0.000042
iter 1200: loss 0.1715, lr 0.000042

--- Validation at iteration 1250 ---
step 1250: val loss 1.1678, val accuracy 0.6753
Logging validation metrics to wandb...
[DEBUG] Logging to wandb at iter 1250: {'iter': 1250, 'val/loss': 1.167769193649292, 'val/accuracy': 0.6752577319587629, 'val/f1_score': 0.6514615483127362, 'lr': 4.012438105155218e-05, 'progress': 62.5, 'best/loss': 0.3750099837779999, 'best/accuracy': 0.865979381443299, 'best/f1': 0.8585434875520274, 'best/iter': 1000, 'val/precision_negative': np.float64(0.5774647887323944), 'val/recall_negative': np.float64(1.0), 'val/f1_negative': np.float64(0.7321428571428571), 'val/precision_neutral': np.float64(0.9423076923076923), 'val/recall_neutral': np.float64(0.44954128440366975), 'val/f1_neutral': np.float64(0.6086956521739131), 'val/precision_positive': np.float64(0.0), 'val/recall_positive': np.float64(0.0), 'val/f1_positive': np.float64(0.0), 'val/conf_matrix_negative_negative': np.int64(82), 'val/conf_matrix_negative_neutral': np.int64(0), 'val/conf_matrix_negative_positive': np.int64(0), 'val/conf_matrix_neutral_negative': np.int64(60), 'val/conf_matrix_neutral_neutral': np.int64(49), 'val/conf_matrix_neutral_positive': np.int64(0), 'val/conf_matrix_positive_negative': np.int64(0), 'val/conf_matrix_positive_neutral': np.int64(3), 'val/conf_matrix_positive_positive': np.int64(0), 'val/conf_matrix_plot': CustomChart(table=<wandb.sdk.data_types.table.Table object at 0x0000020E49E07F10>, spec=CustomChartSpec(spec_name='wandb/confusion_matrix/v1', fields={'Actual': 'Actual', 'Predicted': 'Predicted', 'nPredictions': 'nPredictions'}, string_fields={'title': 'Confusion Matrix Curve'}, key='', panel_type='Vega2', split_table=False))}
Wandb logging completed.
Saving checkpoint to scratch-sentiment-gpt2\ckpt.pt
Checkpoint saved successfully: 1422.31 MB
--- End of validation at iteration 1250 ---

iter 1250: loss 0.1962, lr 0.000040
iter 1300: loss 0.3005, lr 0.000038
iter 1350: loss 0.2132, lr 0.000037
iter 1400: loss 0.1885, lr 0.000037
iter 1450: loss 0.1747, lr 0.000035

--- Validation at iteration 1500 ---
step 1500: val loss 0.3918, val accuracy 0.8918
Logging validation metrics to wandb...
[DEBUG] Logging to wandb at iter 1500: {'iter': 1500, 'val/loss': 0.39177292585372925, 'val/accuracy': 0.8917525773195877, 'val/f1_score': 0.8869398080969999, 'lr': 3.3121851104386705e-05, 'progress': 75.0, 'best/loss': 0.3750099837779999, 'best/accuracy': 0.8917525773195877, 'best/f1': 0.8869398080969999, 'best/iter': 1000, 'val/precision_negative': np.float64(0.8421052631578947), 'val/recall_negative': np.float64(0.975609756097561), 'val/f1_negative': np.float64(0.903954802259887), 'val/precision_neutral': np.float64(0.9489795918367347), 'val/recall_neutral': np.float64(0.8532110091743119), 'val/f1_neutral': np.float64(0.8985507246376812), 'val/precision_positive': np.float64(0.0), 'val/recall_positive': np.float64(0.0), 'val/f1_positive': np.float64(0.0), 'val/conf_matrix_negative_negative': np.int64(80), 'val/conf_matrix_negative_neutral': np.int64(2), 'val/conf_matrix_negative_positive': np.int64(0), 'val/conf_matrix_neutral_negative': np.int64(15), 'val/conf_matrix_neutral_neutral': np.int64(93), 'val/conf_matrix_neutral_positive': np.int64(1), 'val/conf_matrix_positive_negative': np.int64(0), 'val/conf_matrix_positive_neutral': np.int64(3), 'val/conf_matrix_positive_positive': np.int64(0), 'val/conf_matrix_plot': CustomChart(table=<wandb.sdk.data_types.table.Table object at 0x0000020E49E13BD0>, spec=CustomChartSpec(spec_name='wandb/confusion_matrix/v1', fields={'Actual': 'Actual', 'Predicted': 'Predicted', 'nPredictions': 'nPredictions'}, string_fields={'title': 'Confusion Matrix Curve'}, key='', panel_type='Vega2', split_table=False))}
Wandb logging completed.
Saving checkpoint to scratch-sentiment-gpt2\ckpt.pt
Checkpoint saved successfully: 1422.31 MB
--- End of validation at iteration 1500 ---

iter 1500: loss 0.1255, lr 0.000033
iter 1550: loss 0.1006, lr 0.000033
iter 1600: loss 0.1007, lr 0.000031
iter 1650: loss 0.0945, lr 0.000029
iter 1700: loss 0.0829, lr 0.000029

--- Validation at iteration 1750 ---
step 1750: val loss 0.3277, val accuracy 0.8814
Logging validation metrics to wandb...
[DEBUG] Logging to wandb at iter 1750: {'iter': 1750, 'val/loss': 0.327678382396698, 'val/accuracy': 0.8814432989690721, 'val/f1_score': 0.8802970624835885, 'lr': 2.739125298538085e-05, 'progress': 87.5, 'best/loss': 0.327678382396698, 'best/accuracy': 0.8917525773195877, 'best/f1': 0.8869398080969999, 'best/iter': 1750, 'val/precision_negative': np.float64(0.8604651162790697), 'val/recall_negative': np.float64(0.9024390243902439), 'val/f1_negative': np.float64(0.8809523809523809), 'val/precision_neutral': np.float64(0.9056603773584906), 'val/recall_neutral': np.float64(0.8807339449541285), 'val/f1_neutral': np.float64(0.8930232558139535), 'val/precision_positive': np.float64(0.5), 'val/recall_positive': np.float64(0.3333333333333333), 'val/f1_positive': np.float64(0.4), 'val/conf_matrix_negative_negative': np.int64(74), 'val/conf_matrix_negative_neutral': np.int64(8), 'val/conf_matrix_negative_positive': np.int64(0), 'val/conf_matrix_neutral_negative': np.int64(12), 'val/conf_matrix_neutral_neutral': np.int64(96), 'val/conf_matrix_neutral_positive': np.int64(1), 'val/conf_matrix_positive_negative': np.int64(0), 'val/conf_matrix_positive_neutral': np.int64(2), 'val/conf_matrix_positive_positive': np.int64(1), 'val/conf_matrix_plot': CustomChart(table=<wandb.sdk.data_types.table.Table object at 0x0000020E908FC390>, spec=CustomChartSpec(spec_name='wandb/confusion_matrix/v1', fields={'Actual': 'Actual', 'Predicted': 'Predicted', 'nPredictions': 'nPredictions'}, string_fields={'title': 'Confusion Matrix Curve'}, key='', panel_type='Vega2', split_table=False))}
Wandb logging completed.
Saving checkpoint to scratch-sentiment-gpt2\ckpt.pt
Checkpoint saved successfully: 1422.31 MB
--- End of validation at iteration 1750 ---

iter 1750: loss 0.0873, lr 0.000027
iter 1800: loss 0.0924, lr 0.000025
iter 1850: loss 0.1329, lr 0.000024
iter 1900: loss 0.0607, lr 0.000024
iter 1950: loss 0.0495, lr 0.000022

--- Validation at iteration 2000 ---
step 2000: val loss 0.4309, val accuracy 0.9021
Logging validation metrics to wandb...
[DEBUG] Logging to wandb at iter 2000: {'iter': 2000, 'val/loss': 0.4308828115463257, 'val/accuracy': 0.9020618556701031, 'val/f1_score': 0.9007248640596914, 'lr': 1.9827259912808556e-05, 'progress': 100.0, 'best/loss': 0.327678382396698, 'best/accuracy': 0.9020618556701031, 'best/f1': 0.9007248640596914, 'best/iter': 1750, 'val/precision_negative': np.float64(0.851063829787234), 'val/recall_negative': np.float64(0.975609756097561), 'val/f1_negative': np.float64(0.9090909090909091), 'val/precision_neutral': np.float64(0.9591836734693877), 'val/recall_neutral': np.float64(0.8623853211009175), 'val/f1_neutral': np.float64(0.9082125603864735), 'val/precision_positive': np.float64(0.5), 'val/recall_positive': np.float64(0.3333333333333333), 'val/f1_positive': np.float64(0.4), 'val/conf_matrix_negative_negative': np.int64(80), 'val/conf_matrix_negative_neutral': np.int64(2), 'val/conf_matrix_negative_positive': np.int64(0), 'val/conf_matrix_neutral_negative': np.int64(14), 'val/conf_matrix_neutral_neutral': np.int64(94), 'val/conf_matrix_neutral_positive': np.int64(1), 'val/conf_matrix_positive_negative': np.int64(0), 'val/conf_matrix_positive_neutral': np.int64(2), 'val/conf_matrix_positive_positive': np.int64(1), 'val/conf_matrix_plot': CustomChart(table=<wandb.sdk.data_types.table.Table object at 0x0000020E90954610>, spec=CustomChartSpec(spec_name='wandb/confusion_matrix/v1', fields={'Actual': 'Actual', 'Predicted': 'Predicted', 'nPredictions': 'nPredictions'}, string_fields={'title': 'Confusion Matrix Curve'}, key='', panel_type='Vega2', split_table=False))}
Wandb logging completed.
Saving checkpoint to scratch-sentiment-gpt2\ckpt.pt
Checkpoint saved successfully: 1422.31 MB
--- End of validation at iteration 2000 ---

Final results: val loss 0.4309, val accuracy 0.9021, val f1 0.9007
Confusion Matrix:
[[80  2  0]
 [14 94  1]
 [ 0  2  1]]

Class-specific metrics:
  Negative -  Precision: 0.8511,  Recall: 0.9756,  F1: 0.9091
  Neutral -  Precision: 0.9592,  Recall: 0.8624,  F1: 0.9082
  Positive -  Precision: 0.5000,  Recall: 0.3333,  F1: 0.4000
